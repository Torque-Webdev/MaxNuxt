(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{672:function(t,e,l){"use strict";l.r(e);l(62),l(12),l(18),l(84);var o=l(122),n=l(19),c={components:{mdbInput:o.mdbInput,mdbBtn:o.mdbBtn,mdbContainer:o.mdbContainer,mdbIcon:o.mdbIcon,mdbModalHeader:o.mdbModalHeader,mdbModalTitle:o.mdbModalTitle,mdbModalBody:o.mdbModalBody,mdbModalFooter:o.mdbModalFooter,mdbModal:o.mdbModal,mdbCol:o.mdbCol,mdbRow:o.mdbRow},data:function(){return{toDeleteItem:{id:"",title:"",alt:"",url:""},circuit:{id:"",url:"",title:"",alt:""},deleteModal:!1,uploadImage:!1,existsModal:!1,updatedImage:null,file:"",msg:{message:"",type:""},img:{id:"",alt:"",content:{}},addCircuitModel:!1,defaultImage:"https://firebasestorage.googleapis.com/v0/b/jhr-developments-c5bba.appspot.com/o/images%2Fimg-placeholder.png?alt=media&token=7d9c5978-d45d-4049-91d9-ceb235823db7"}},computed:{circuitList:function(){return this.$store.getters["circuits/getCircuits"]},uploadMsg:function(){return this.$store.getters["images/getMsg"]}},methods:{reset:function(){this.file="",this.img={id:"",content:"",alt:""},this.circuit={id:"",imgId:"",url:"",title:"",alt:""}},newImage:function(){this.uploadImage=!0},checkFile:function(t){var e=this;this.file=t.target.files[0],n.e.where("name","==",this.file.name).get().then((function(t){t.forEach((function(t){t.exists&&(e.existsModal=!0,e.uploadImage=!1,e.img.content=t.data(),e.img.id=t.id)}))}))},deleteItem:function(t){this.deleteModal=!0,this.toDeleteItem={id:t.id,title:t.title,alt:t.alt,url:t.url}},cancelDelete:function(){this.toDeleteItem={id:"",title:"",alt:"",url:""},this.deleteModal=!1},confirmDelete:function(){var t=this;n.c.doc(this.toDeleteItem.id).delete().then((function(){t.deleteModal=!1,t.msg={type:"danger",message:"Image deleted"},setTimeout((function(){t.msg={type:"",message:""}}),2e3)})).catch((function(e){t.msg={type:"warning",message:e.message},setTimeout((function(){t.msg={type:"",message:""}}),2e3)}))},saveFile:function(){var t=this,e={};e.file=this.file,e.alt=this.img.alt,this.$store.dispatch("images/uploadImage",e).then((function(img){t.img.content=img,t.circuit.imgId=t.img.content.id,t.circuit.url=t.img.content.url,t.circuit.alt=t.img.content.alt})).then((function(){t.$store.dispatch("global/setLoading",!1),t.file="",t.img.alt="",setTimeout((function(){t.uploadImage=!1}),3e3)}))},closeImageUpload:function(){this.uploadImage=!1,this.file="",this.img.alt=""},addCircuit:function(){var t=this;n.c.add({url:this.circuit.url,imgId:this.circuit.imgId,alt:this.circuit.alt,title:this.circuit.title,createdOn:new Date}).then((function(){t.msg={type:"success",message:"Circuit added"},t.reset(),setTimeout((function(){t.msg={type:"",message:""}}),2e3)})).catch((function(e){t.msg={type:"warning",message:e.message},setTimeout((function(){t.msg={type:"",message:""}}),2e3)}))},cancelAdd:function(){this.addCircuitModel=!1,this.reset()},confirmUse:function(){this.circuit.imgId=this.img.id,this.existsModal=!1,this.circuit.url=this.img.content.url,this.circuit.alt=this.img.content.alt,this.file="",this.img.alt=""},declineUse:function(){this.existsModal=!1,this.img.content="",this.img.id="",this.type="",this.file="",this.img.alt=""},saveCircuit:function(){this.addCircuit(),this.addCircuitModel=!1}}},d=l(75),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",[l("div",{staticClass:"container text-center"},[l("mdb-btn",{staticClass:"ml-0",attrs:{color:"primary"},on:{click:function(e){t.addCircuitModel=!0}}},[t._v("Add new circuit")])],1),t._v(" "),l("mdb-container",{staticClass:"p-0 pt-5",attrs:{fluid:""}},[l("mdb-row",t._l(t.circuitList,(function(e,o){return l("mdb-col",{key:o,staticClass:"col-4"},[l("img",{staticClass:"img-fluid",attrs:{src:e.url,alt:e.alt}}),t._v(" "),l("p",[t._v("name: "+t._s(e.title))]),t._v(" "),l("p",[t._v("alt: "+t._s(e.alt))]),t._v(" "),l("div",{staticClass:"text-center"},[l("a",{on:{click:function(l){return t.deleteItem(e)}}},[l("mdb-icon",{attrs:{icon:"trash-alt"}})],1)])])})),1)],1),t._v(" "),l("transition",{attrs:{name:"fade"}},[""!=t.msg.message?l("div",{staticClass:"pl-5 mt-4 text-white text-center",class:"bg-"+t.msg.type},[l("p",[t._v(t._s(t.msg.message))])]):t._e()]),t._v(" "),l("mdb-modal",{attrs:{top:"",position:"top","full-height":"",direction:"top",show:t.addCircuitModel},on:{close:t.cancelAdd}},[l("mdb-modal-header",[l("mdb-modal-title",[t._v("Add circuit")])],1),t._v(" "),l("mdb-modal-body",[l("form",{staticClass:"p-2",on:{submit:function(t){t.preventDefault()}}},[l("mdb-col",{staticClass:"text-center pt-2"},[t.circuit.url?l("img",{staticClass:"img-fluid",attrs:{src:t.circuit.url,alt:t.circuit.alt}}):l("img",{staticClass:"img-fluid",attrs:{src:t.defaultImage,alt:"Placeholder image"}})]),t._v(" "),l("mdb-btn",{staticClass:"ml-3",attrs:{color:"primary",inline:""},on:{click:t.newImage}},[t._v("Circuit Image")]),t._v(" "),l("div",{staticClass:"md-form"},[l("mdb-input",{attrs:{label:"Title",inline:""},model:{value:t.circuit.title,callback:function(e){t.$set(t.circuit,"title","string"==typeof e?e.trim():e)},expression:"circuit.title"}})],1)],1)]),t._v(" "),l("mdb-modal-footer",[l("mdb-btn",{attrs:{color:"secondary"},nativeOn:{click:function(e){return t.cancelAdd.apply(null,arguments)}}},[t._v("Close")]),t._v(" "),l("mdb-btn",{attrs:{color:"primary"},on:{click:t.saveCircuit}},[t._v("Save")])],1)],1),t._v(" "),l("mdb-modal",{attrs:{frame:"",position:"top",direction:"top",show:t.deleteModal},on:{close:function(e){t.deleteModal=!1}}},[l("mdb-modal-body",{staticClass:"text-center"},[l("span",{staticClass:"text-danger"},[t._v("Are you sure you want to delete this circuit ? ( any documents that\n        use this circuit will need to be changed )")]),t._v("\n      "+t._s(t.toDeleteItem.title)+"\n      "),l("mdb-btn",{attrs:{color:"secondary"},nativeOn:{click:function(e){return t.cancelDelete.apply(null,arguments)}}},[t._v("Close")]),t._v(" "),l("mdb-btn",{attrs:{color:"danger"},on:{click:t.confirmDelete}},[t._v("Delete")])],1)],1),t._v(" "),l("mdb-modal",{attrs:{size:"md",show:t.existsModal},on:{close:function(e){t.existsModal=!1}}},[l("mdb-modal-header",[l("mdb-modal-title",[t._v("Image exists with that name")])],1),t._v(" "),l("mdb-modal-body",[l("div",{staticClass:"row col-12 col-md-6 col-lg-4 py-3"},[l("p",[t._v("Would you like to use this one ?")])]),t._v(" "),l("img",{staticClass:"img-fluid",attrs:{src:t.img.content.url,alt:t.img.content.alt}})]),t._v(" "),l("mdb-modal-footer",[l("mdb-btn",{attrs:{color:"secondary",size:"sm"},nativeOn:{click:function(e){return t.declineUse.apply(null,arguments)}}},[t._v("No")]),t._v(" "),l("mdb-btn",{attrs:{color:"primary",size:"sm"},on:{click:t.confirmUse}},[t._v("Yes")])],1)],1),t._v(" "),l("mdb-modal",{attrs:{size:"md",show:t.uploadImage},on:{close:t.closeImageUpload}},[l("mdb-modal-header",[l("mdb-modal-title",[t._v("Upload image")])],1),t._v(" "),l("mdb-modal-body",[l("div",{staticClass:"row"},[l("div",{staticClass:"col-12"},[l("div",{staticClass:"md-form"},[l("mdb-input",{attrs:{label:"Description",inline:""},model:{value:t.img.alt,callback:function(e){t.$set(t.img,"alt","string"==typeof e?e.trim():e)},expression:"img.alt"}})],1)]),t._v(" "),l("div",{staticClass:"col-12"},[l("div",{staticClass:"input-group"},[l("div",{staticClass:"input-group-prepend"},[l("span",{staticClass:"input-group-text",attrs:{id:"imageInput"}},[t._v("Upload")])]),t._v(" "),l("div",{staticClass:"custom-file"},[l("input",{ref:"imageInput",staticClass:"custom-file-input",attrs:{id:"imageInput",type:"file","aria-describedby":"imageInput",accept:"image/jpeg image/png"},on:{change:function(e){return t.checkFile(e)}}}),t._v(" "),t.file.name?l("label",{staticClass:"custom-file-label",attrs:{for:"inputGroupFile01"}},[t._v(t._s(t.file.name))]):l("label",{staticClass:"custom-file-label",attrs:{for:"inputGroupFile01"}},[t._v("Image")])])])])])]),t._v(" "),l("mdb-modal-footer",[l("mdb-btn",{attrs:{color:"secondary",size:"sm"},nativeOn:{click:function(e){return t.closeImageUpload.apply(null,arguments)}}},[t._v("Close")]),t._v(" "),l("mdb-btn",{attrs:{color:"primary",size:"sm",disabled:""==t.img.alt},on:{click:function(e){return t.saveFile(t.type)}}},[t._v("Save")])],1),t._v(" "),l("transition",{attrs:{name:"fade"}},[""!=t.uploadMsg.message?l("div",{staticClass:"text-white text-center",class:"bg-"+t.uploadMsg.type},[l("p",[t._v(t._s(t.uploadMsg.message))])]):t._e()])],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);