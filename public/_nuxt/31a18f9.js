(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{670:function(t,e,c){"use strict";c.r(e);c(419),c(69),c(84),c(62),c(12),c(18);var l=c(4),d=c.n(l),r=c(122),o=c(19),n={components:{mdbInput:r.mdbInput,mdbBtn:r.mdbBtn,mdbContainer:r.mdbContainer,mdbIcon:r.mdbIcon,mdbModalHeader:r.mdbModalHeader,mdbModalTitle:r.mdbModalTitle,mdbModalBody:r.mdbModalBody,mdbModalFooter:r.mdbModalFooter,mdbModal:r.mdbModal,mdbCol:r.mdbCol,mdbRow:r.mdbRow},filters:{formatDate:function(t){if(!t)return"-";var e=t;return d()(e).format("Do MMM YYYY")}},props:{size:{type:Number,required:!1,default:10}},data:function(){return{fixture:{id:"",date:"",date2:"",circuit:{}},circuit:{id:"",url:"",title:"",alt:""},clickedFixture:{id:"",date:"",date2:"",circuit:{}},addCircuitModel:!1,selCircuitModel:!1,pageNumber:0,msg:"",editModal:!1,existsModal:!1,deleteModal:!1,toDeleteFixture:{id:"",date:"",date2:"",circuit:{}},updatedImage:null,uploadImage:!1,file:"",img:{id:"",content:"",alt:""},confirmUpdate:!1,type:"",defaultImage:"https://firebasestorage.googleapis.com/v0/b/jhr-developments-c5bba.appspot.com/o/images%2Fimg-placeholder.png?alt=media&token=7d9c5978-d45d-4049-91d9-ceb235823db7"}},computed:{fixtures:function(){return this.$store.getters["calendar/getFixtures"]},updatedCircuit:function(){return this.$store.getters["circuits/getCircuit"]},circuits:function(){return this.$store.getters["circuits/getCircuits"]},uploadMsg:function(){return this.$store.getters["images/getMsg"]},pageCount:function(){var t=this.fixtures.length,s=this.size;return Math.ceil(t/s)},paginatedData:function(){var t=this.pageNumber*this.size,e=t+this.size;return this.fixtures.slice(t,e)}},methods:{reset:function(){this.fixture={id:"",date:"",date2:"",circuit:{}},this.file="",this.img={id:"",content:"",alt:""},this.circuit={id:"",imgId:"",url:"",title:"",alt:""}},addFixture:function(){var t=this;o.b.add({date:this.fixture.date,date2:this.fixture.date2,circuit:this.fixture.circuit,createdOn:new Date}).then((function(){t.reset(),t.msg={type:"success",message:"Fixture added"},setTimeout((function(){t.msg={type:"",message:""}}),2e3)})).catch((function(e){t.msg={type:"warning",message:e.message},setTimeout((function(){t.msg={type:"",message:""}}),2e3)}))},addCircuit:function(){var t=this;o.c.add({url:this.circuit.url,imgId:this.circuit.imgId,alt:this.img.content.alt,title:this.circuit.title,createdOn:new Date}).then((function(e){o.c.doc(e.id).get().then((function(e){t.circuit={id:e.id,url:e.data().url,title:e.data().title,alt:e.data().alt},console.log(t.circuit)}))})).then((function(){t.fixture.circuit=t.circuit,t.msg={type:"success",message:"Circuit added"},setTimeout((function(){t.msg={type:"",message:""}}),2e3)})).catch((function(e){t.msg={type:"warning",message:e.message},setTimeout((function(){t.msg={type:"",message:""}}),2e3)}))},saveCircuit:function(){this.addCircuit(),this.addCircuitModel=!1,"edit"===this.type&&(this.editModal=!0,this.clickedFixture.circuit.title=this.circuit.title)},cancelAdd:function(){this.addCircuitModel=!1,this.reset()},newImage:function(){this.uploadImage=!0},checkFile:function(t){var e=this;this.file=t.target.files[0],o.e.where("name","===",this.file.name).get().then((function(t){t.forEach((function(t){t.exists&&(e.existsModal=!0,e.uploadImage=!1,e.img.content=t.data(),e.img.id=t.id)}))}))},saveFile:function(){var t=this,e={};e.file=this.file,e.alt=this.img.alt,this.$store.dispatch("images/uploadImage",e).then((function(img){t.img.content=img,t.circuit.imgId=t.img.content.id,t.circuit.url=t.img.content.url,t.circuit.alt=t.img.content.alt,"edit"===t.type&&(t.clickedFixture.circuit.imgId=t.circuit.imgId,t.clickedFixture.circuit.url=t.circuit.url,t.clickedFixture.circuit.alt=t.img.alt)})).then((function(){t.$store.dispatch("global/setLoading",!1),t.file="",t.img.alt="",setTimeout((function(){t.uploadImage=!1}),3e3)}))},closeImageUpload:function(){this.uploadImage=!1,this.type="",this.file="",this.img.alt=""},confirmUse:function(){this.circuit.imgId=this.img.id,this.existsModal=!1,this.circuit.url=this.img.content.url,this.img.alt=this.img.content.alt,this.file="",this.img.alt="","edit"===this.type&&(this.clickedFixture.circuit.imgId=this.circuit.imgId,this.existsModal=!1,this.clickedFixture.circuit.url=this.circuit.url,this.clickedFixture.circuit.alt=this.img.alt,this.file="",this.img.alt="")},declineUse:function(){this.existsModal=!1,this.img.content="",this.img.id="",this.type="",this.file="",this.img.alt=""},submitForm:function(){var t=this;""===this.fixture.date||""===this.circuit.title?(this.msg={type:"warning",message:"Missing information check the form is completely filled"},setTimeout((function(){t.msg={type:"",message:""}}),2e3)):this.addFixture()},nextPage:function(){this.pageNumber++},prevPage:function(){this.pageNumber--},deleteFixture:function(t){this.deleteModal=!0,this.toDeleteFixture.title=t.circuit.title,this.toDeleteFixture.date=t.date,this.toDeleteFixture.date2=t.date2,this.toDeleteFixture.id=t.id},cancelDelete:function(){this.toDeleteFixture={id:"",title:"",date:""},this.deleteModal=!1},confirmDelete:function(){var t=this;o.b.doc(this.toDeleteFixture.id).delete().then((function(){t.deleteModal=!1,t.msg={type:"danger",message:"Fixture deleted"},setTimeout((function(){t.msg={type:"",message:""}}),2e3)})).catch((function(e){t.msg={type:"warning",message:e.message},setTimeout((function(){t.msg={type:"",message:""}}),2e3)}))},editFixture:function(t){this.editModal=!0,this.clickedFixture.id=t.id,this.clickedFixture.date=t.date,this.clickedFixture.date2=t.date2,this.clickedFixture.circuit.title=t.circuit.title,this.clickedFixture.circuit.id=t.circuit.id,this.clickedFixture.circuit.imgId=t.circuit.imgId,this.clickedFixture.circuit.url=t.circuit.url,this.clickedFixture.circuit.alt=t.circuit.alt},cancelEdit:function(){this.clickedFixture={id:"",date:"",circuit:{id:"",url:"",title:"",alt:""}},this.reset(),this.editModal=!1},addCircuitEdit:function(){this.addCircuitModel=!0,this.type="edit",this.editModal=!1},selCircuitEdit:function(){this.selCircuitModel=!0,this.type="edit",this.editModal=!1},saveEdit:function(){var t=this;""!==this.circuit.title&&(this.clickedFixture.circuit.title=this.circuit.title),o.b.doc(this.clickedFixture.id).update({date:this.clickedFixture.date,date2:this.clickedFixture.date2,circuit:{title:this.clickedFixture.circuit.title,id:this.clickedFixture.circuit.id,imgId:this.clickedFixture.circuit.imgId,url:this.clickedFixture.circuit.url,alt:this.clickedFixture.circuit.alt},createdOn:new Date}).then((function(){t.cancelEdit(),t.msg={type:"success",message:"Fixture updated"},setTimeout((function(){t.msg={type:"",message:""}}),2e3)})).catch((function(e){t.editMsg={type:"warning",message:e.message},setTimeout((function(){t.editMsg={type:"",message:""}}),2e3)}))},selected:function(t){this.circuit=t,this.fixture.circuit.title=t.title,this.fixture.circuit=t,"edit"===this.type&&(this.clickedFixture.circuit.title=t.title,this.clickedFixture.circuit=t)},saveSel:function(){this.selCircuitModel=!1,"edit"===this.type&&(this.editModal=!0)}}},m=c(75),component=Object(m.a)(n,(function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("div",[c("mdb-container",[c("h3",{staticClass:"pb-3 text-center"},[t._v("Calendar")]),t._v(" "),c("mdb-row",[c("mdb-col",{staticClass:"pt-2"},[c("mdb-btn",{staticClass:"ml-0",attrs:{color:"primary"},on:{click:function(e){t.addCircuitModel=!0}}},[t._v("Add circuit")]),t._v(" "),c("mdb-btn",{attrs:{color:"secondary"},on:{click:function(e){t.selCircuitModel=!0}}},[t._v("Select circuit")])],1)],1),t._v(" "),c("mdb-row",[c("mdb-col",[c("form",{staticClass:"pt-2",on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[c("div",{staticClass:"row"},[t.circuit.title?c("div",{staticClass:"md-form col-12 col-md-6 col-lg-4"},[c("img",{attrs:{src:t.circuit.url,alt:t.circuit.alt}}),t._v(" "),c("p",{staticClass:"text-center pt-3"},[t._v(t._s(t.circuit.title))])]):t._e()]),t._v(" "),c("div",{staticClass:"row"},[c("div",{staticClass:"md-form col-12 col-md-6 col-lg-4"},[t._v("\n              Start date:\n              "),c("mdb-input",{attrs:{type:"date",inline:""},model:{value:t.fixture.date,callback:function(e){t.$set(t.fixture,"date","string"==typeof e?e.trim():e)},expression:"fixture.date"}})],1),t._v(" "),c("div",{staticClass:"md-form col-12 col-md-6 col-lg-4"},[t._v("\n              End date:\n              "),c("mdb-input",{attrs:{type:"date",inline:""},model:{value:t.fixture.date2,callback:function(e){t.$set(t.fixture,"date2","string"==typeof e?e.trim():e)},expression:"fixture.date2"}})],1)]),t._v(" "),c("mdb-btn",{staticClass:"ml-0",attrs:{color:"primary",type:"submit"}},[t._v("Add Fixture")])],1)])],1)],1),t._v(" "),c("transition",{attrs:{name:"fade"}},[""!=t.msg.message?c("div",{staticClass:"pl-5 mt-2 text-white text-center",class:"bg-"+t.msg.type},[c("p",[t._v(t._s(t.msg.message))])]):t._e()]),t._v(" "),t.paginatedData?c("mdb-container",{staticClass:"pt-5",attrs:{fluid:""}},[c("mdb-row",[c("mdb-col",[c("table",{staticClass:"table"},[c("thead",{staticClass:"black text-white"},[c("tr",[c("th",{attrs:{scope:"col"}},[t._v("Title")]),t._v(" "),c("th",{attrs:{scope:"col"}},[t._v("Date")]),t._v(" "),c("th",{attrs:{scope:"col"}},[t._v("Action")])])]),t._v(" "),c("tbody",t._l(t.paginatedData,(function(e,l){return c("tr",{key:l},[c("th",{attrs:{scope:"row"}},[t._v(t._s(e.circuit.title))]),t._v(" "),c("td",[t._v("\n                "+t._s(t._f("formatDate")(e.date))+" -\n                "+t._s(t._f("formatDate")(e.date2))+"\n              ")]),t._v(" "),c("td",[c("a",{staticClass:"mr-1",on:{click:function(c){return t.editFixture(e)}}},[c("mdb-icon",{attrs:{icon:"edit"}})],1),t._v(" "),c("a",{staticClass:"ml-1",on:{click:function(c){return t.deleteFixture(e)}}},[c("mdb-icon",{attrs:{icon:"trash-alt"}})],1)])])})),0)])]),t._v(" "),c("mdb-col",{staticClass:"col-12 text-center"},[c("mdb-btn",{class:{"d-none":0===t.pageNumber},attrs:{color:"primary"},on:{click:t.prevPage}},[c("mdb-icon",{attrs:{icon:"angle-double-left"}})],1),t._v(" "),c("mdb-btn",{class:{"d-none":t.pageNumber>=t.pageCount-1},attrs:{color:"primary"},on:{click:t.nextPage}},[c("mdb-icon",{attrs:{icon:"angle-double-right"}})],1)],1)],1)],1):t._e(),t._v(" "),c("mdb-modal",{attrs:{top:"",position:"top","full-height":"",direction:"top",show:t.addCircuitModel},on:{close:t.cancelAdd}},[c("mdb-modal-header",[c("mdb-modal-title",[t._v("Add circuit")])],1),t._v(" "),c("mdb-modal-body",[c("form",{staticClass:"p-2",on:{submit:function(t){t.preventDefault()}}},[c("mdb-col",{staticClass:"text-center pt-2"},[t.circuit.url?c("img",{staticClass:"img-fluid",attrs:{src:t.circuit.url,alt:t.circuit.alt}}):c("img",{staticClass:"img-fluid",attrs:{src:t.defaultImage,alt:"Placeholder image"}})]),t._v(" "),c("mdb-btn",{staticClass:"ml-3",attrs:{color:"primary",inline:""},on:{click:t.newImage}},[t._v("Circuit Image")]),t._v(" "),c("div",{staticClass:"md-form"},[c("mdb-input",{attrs:{label:"Title",inline:""},model:{value:t.circuit.title,callback:function(e){t.$set(t.circuit,"title","string"==typeof e?e.trim():e)},expression:"circuit.title"}})],1)],1)]),t._v(" "),c("mdb-modal-footer",[c("mdb-btn",{attrs:{color:"secondary"},nativeOn:{click:function(e){return t.cancelAdd.apply(null,arguments)}}},[t._v("Close")]),t._v(" "),c("mdb-btn",{attrs:{color:"primary"},on:{click:t.saveCircuit}},[t._v("Save")])],1)],1),t._v(" "),c("mdb-modal",{attrs:{top:"",position:"top","full-height":"",direction:"top",show:t.selCircuitModel},on:{close:function(e){t.selCircuitModel=!1}}},[c("mdb-modal-header",[c("mdb-modal-title",[t._v("Select circuit")])],1),t._v(" "),c("mdb-modal-body",[c("div",{staticClass:"container-fluid"},[c("div",{staticClass:"row"},t._l(t.circuits,(function(e,l){return c("div",{key:l,staticClass:"col-4 p-0"},[c("div",{staticClass:"custom-control custom-radio custom-control-inline"},[c("img",{staticClass:"img-fluid",attrs:{src:e.url,alt:e.alt}}),t._v(" "),c("input",{staticClass:"custom-control-input",attrs:{id:e.id,type:"radio",name:"circuits"},on:{click:function(c){return t.selected(e)}}}),t._v(" "),c("label",{staticClass:"custom-control-label",attrs:{for:e.id}},[t._v(t._s(e.title))])])])})),0)])]),t._v(" "),c("mdb-modal-footer",[c("mdb-btn",{attrs:{color:"secondary"},nativeOn:{click:function(e){t.selCircuitModel=!1}}},[t._v("Close")]),t._v(" "),c("mdb-btn",{attrs:{color:"primary"},on:{click:t.saveSel}},[t._v("Confirm")])],1)],1),t._v(" "),c("mdb-modal",{attrs:{top:"",position:"top","full-height":"",direction:"top",show:t.editModal},on:{close:t.cancelEdit}},[c("mdb-modal-header",[c("mdb-modal-title",[t._v("Edit fixture")])],1),t._v(" "),c("mdb-modal-body",[c("form",{staticClass:"p-2",on:{submit:function(t){t.preventDefault()}}},[c("mdb-col",{staticClass:"text-center pt-2"},[c("img",{staticClass:"img-fluid",attrs:{src:t.clickedFixture.circuit.url,alt:t.clickedFixture.circuit.alt}}),t._v(" "),c("p",{staticClass:"text-center"},[t._v(t._s(t.clickedFixture.circuit.title))])]),t._v(" "),c("mdb-col",{staticClass:"pt-2"},[c("mdb-btn",{staticClass:"ml-0",attrs:{color:"primary"},on:{click:t.addCircuitEdit}},[t._v("Add new circuit")]),t._v(" "),c("mdb-btn",{attrs:{color:"secondary"},on:{click:t.selCircuitEdit}},[t._v("Select new circuit")])],1),t._v(" "),c("div",{staticClass:"md-form col-12 col-md-6 col-lg-4"},[t._v("\n          Start date:\n          "),c("mdb-input",{attrs:{type:"date",inline:""},model:{value:t.clickedFixture.date,callback:function(e){t.$set(t.clickedFixture,"date","string"==typeof e?e.trim():e)},expression:"clickedFixture.date"}}),t._v("\n          End date:\n          "),c("mdb-input",{attrs:{type:"date",inline:""},model:{value:t.clickedFixture.date2,callback:function(e){t.$set(t.clickedFixture,"date2","string"==typeof e?e.trim():e)},expression:"clickedFixture.date2"}})],1)],1)]),t._v(" "),c("mdb-modal-footer",[c("mdb-btn",{attrs:{color:"secondary"},nativeOn:{click:function(e){return t.cancelEdit.apply(null,arguments)}}},[t._v("Close")]),t._v(" "),c("mdb-btn",{attrs:{color:"primary"},on:{click:t.saveEdit}},[t._v("Save changes")])],1)],1),t._v(" "),c("mdb-modal",{attrs:{frame:"",position:"top",direction:"top",show:t.deleteModal},on:{close:function(e){t.deleteModal=!1}}},[c("mdb-modal-body",{staticClass:"text-center"},[c("span",{staticClass:"text-danger"},[t._v("Are you sure you want to delete this fixture")]),t._v("\n      "+t._s(t.toDeleteFixture.title)+", "+t._s(t.toDeleteFixture.date)+"\n      "),c("mdb-btn",{attrs:{color:"secondary"},nativeOn:{click:function(e){return t.cancelDelete.apply(null,arguments)}}},[t._v("Close")]),t._v(" "),c("mdb-btn",{attrs:{color:"danger"},on:{click:t.confirmDelete}},[t._v("Delete")])],1)],1),t._v(" "),c("mdb-modal",{attrs:{size:"md",show:t.existsModal},on:{close:function(e){t.existsModal=!1}}},[c("mdb-modal-header",[c("mdb-modal-title",[t._v("Image exists with that name")])],1),t._v(" "),c("mdb-modal-body",[c("div",{staticClass:"row col-12 col-md-6 col-lg-4 py-3"},[c("p",[t._v("Would you like to use this one ?")])]),t._v(" "),c("img",{staticClass:"img-fluid",attrs:{src:t.img.content.url,alt:t.img.content.alt}})]),t._v(" "),c("mdb-modal-footer",[c("mdb-btn",{attrs:{color:"secondary",size:"sm"},nativeOn:{click:function(e){return t.declineUse.apply(null,arguments)}}},[t._v("No")]),t._v(" "),c("mdb-btn",{attrs:{color:"primary",size:"sm"},on:{click:t.confirmUse}},[t._v("Yes")])],1)],1),t._v(" "),c("mdb-modal",{attrs:{size:"md",show:t.uploadImage},on:{close:t.closeImageUpload}},[c("mdb-modal-header",[c("mdb-modal-title",[t._v("Upload image")])],1),t._v(" "),c("mdb-modal-body",[c("div",{staticClass:"row"},[c("div",{staticClass:"col-12"},[c("div",{staticClass:"md-form"},[c("mdb-input",{attrs:{label:"Description",inline:""},model:{value:t.img.alt,callback:function(e){t.$set(t.img,"alt","string"==typeof e?e.trim():e)},expression:"img.alt"}})],1)]),t._v(" "),c("div",{staticClass:"col-12"},[c("div",{staticClass:"input-group"},[c("div",{staticClass:"input-group-prepend"},[c("span",{staticClass:"input-group-text",attrs:{id:"imageInput"}},[t._v("Upload")])]),t._v(" "),c("div",{staticClass:"custom-file"},[c("input",{ref:"imageInput",staticClass:"custom-file-input",attrs:{id:"imageInput",type:"file","aria-describedby":"imageInput",accept:"image/jpeg image/png"},on:{change:function(e){return t.checkFile(e)}}}),t._v(" "),t.file.name?c("label",{staticClass:"custom-file-label",attrs:{for:"inputGroupFile01"}},[t._v(t._s(t.file.name))]):c("label",{staticClass:"custom-file-label",attrs:{for:"inputGroupFile01"}},[t._v("Headline image")])])])])])]),t._v(" "),c("mdb-modal-footer",[c("mdb-btn",{attrs:{color:"secondary",size:"sm"},nativeOn:{click:function(e){return t.closeImageUpload.apply(null,arguments)}}},[t._v("Close")]),t._v(" "),c("mdb-btn",{attrs:{color:"primary",size:"sm",disabled:""===t.img.alt},on:{click:function(e){return t.saveFile(t.type)}}},[t._v("Save")])],1),t._v(" "),c("transition",{attrs:{name:"fade"}},[""!=t.uploadMsg.message?c("div",{staticClass:"text-white text-center",class:"bg-"+t.uploadMsg.type},[c("p",[t._v(t._s(t.uploadMsg.message))])]):t._e()])],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);